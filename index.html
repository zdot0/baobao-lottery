<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026å¤§å¹´åˆä¸€ baobao lottery</title>
    <style>
        :root {
            --cny-red: #da251d;
            --cny-dark-red: #8b0000;
            --cny-gold: #fec33a;
            --cny-light-gold: #ffdf85;
        }

        body {
            background-color: var(--cny-dark-red);
            font-family: "Microsoft YaHei", "SimHei", "PingFang SC", sans-serif;
            text-align: center;
            color: white;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        h1 {
            color: var(--cny-gold);
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            margin-bottom: 5px;
            font-size: 2rem;
        }

        p.subtitle {
            color: var(--cny-light-gold);
            margin-top: 0;
            margin-bottom: 30px;
            font-size: 1.1rem;
        }

        /* å€’è®¡æ—¶æ ·å¼ */
        #countdown-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 50px;
        }

        .timer-box {
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid var(--cny-gold);
            border-radius: 15px;
            padding: 20px 40px;
            margin-top: 20px;
            box-shadow: 0 0 20px rgba(254, 195, 58, 0.2);
        }

        .timer-display {
            font-size: 3rem;
            font-weight: bold;
            color: var(--cny-gold);
            font-family: monospace;
        }
        
        .timer-label {
            font-size: 1rem;
            color: white;
            margin-top: 10px;
        }

        /* è´­ä¹°ç•Œé¢æ ·å¼ */
        #shop-panel {
            background: rgba(255, 255, 255, 0.1);
            border: 2px dashed var(--cny-gold);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            width: 90%;
            max-width: 500px;
        }

        .shop-info {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: var(--cny-light-gold);
        }

        .count-badge {
            font-size: 1.5rem;
            font-weight: bold;
            color: white;
            background: var(--cny-red);
            padding: 5px 15px;
            border-radius: 20px;
            margin: 0 5px;
        }

        .buy-btn {
            background: linear-gradient(to bottom, #ffeb3b, #fbc02d);
            color: #d50000;
            border: none;
            padding: 15px 30px;
            font-size: 1.3rem;
            font-weight: 900;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 6px 0 #c49000, 0 10px 10px rgba(0,0,0,0.3);
            transition: all 0.1s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .buy-btn:active {
            transform: translateY(4px);
            box-shadow: 0 2px 0 #c49000, 0 4px 4px rgba(0,0,0,0.3);
        }

        .buy-btn:disabled {
            background: #ccc;
            color: #666;
            box-shadow: none;
            cursor: not-allowed;
            transform: none;
        }

        /* æ¸¸æˆåŒºåŸŸ */
        #game-area {
            display: none;
            width: 100%;
            flex-direction: column;
            align-items: center;
        }

        .envelope-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(90px, 110px));
            gap: 15px;
            width: 100%;
            max-width: 600px;
            justify-content: center;
        }

        .envelope {
            width: 100%;
            aspect-ratio: 2 / 3;
            background: linear-gradient(135deg, var(--cny-red), #b31b1b);
            border: 2px solid var(--cny-gold);
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            box-shadow: 0 8px 15px rgba(0,0,0,0.4);
            transition: all 0.3s ease;
            transform-style: preserve-3d;
            opacity: 0.6;
            filter: grayscale(0.5);
        }

        .envelope.active-state {
            opacity: 1;
            filter: grayscale(0);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.03); }
            100% { transform: scale(1); }
        }

        .envelope.active-state:hover {
            transform: translateY(-8px) scale(1.05);
            box-shadow: 0 12px 20px rgba(0,0,0,0.6);
        }

        .envelope::before {
            content: "ç¦";
            font-size: 2.5rem;
            color: var(--cny-gold);
            font-family: "Kaiti", "STKaiti", serif;
            font-weight: bold;
        }

        .envelope.opened {
            background: #fff;
            border-color: #ccc;
            cursor: default;
            transform: scale(0.95) !important;
            box-shadow: inset 0 4px 8px rgba(0,0,0,0.2);
            opacity: 1;
            filter: grayscale(0);
            animation: none;
        }

        .envelope.opened::before { display: none; }

        .prize-text {
            display: none;
            color: var(--cny-red);
            font-weight: bold;
            font-size: 1rem;
            text-align: center;
            padding: 5px;
            line-height: 1.3;
        }

        .envelope.opened .prize-text {
            display: block;
            animation: popIn 0.5s ease;
        }

        @keyframes popIn {
            0% { transform: scale(0); opacity: 0; }
            80% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }

        .controls { margin-top: 40px; }

        .reset-btn {
            background: transparent;
            border: 1px solid var(--cny-light-gold);
            color: var(--cny-light-gold);
            padding: 8px 20px;
            border-radius: 20px;
            cursor: pointer;
            margin-top: 20px;
            font-size: 0.9rem;
        }

        /* å¼¹çª—æ ·å¼ */
        #prizeModal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8);
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal-content {
            background: linear-gradient(135deg, var(--cny-red), #b31b1b);
            border: 4px solid var(--cny-gold);
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            max-width: 400px;
            width: 80%;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .modal-content h2 {
            color: var(--cny-gold);
            margin-top: 0;
            font-size: 2rem;
        }

        .modal-content p {
            font-size: 1.5rem;
            font-weight: bold;
            color: white;
            margin: 20px 0;
        }
        
        .modal-btn {
            background-color: var(--cny-gold);
            color: var(--cny-dark-red);
            border: none;
            padding: 10px 30px;
            font-size: 1.1rem;
            font-weight: bold;
            border-radius: 25px;
            cursor: pointer;
        }
    </style>
</head>
<body>

    <h1>ğŸ§§ 2026å¤§å¹´åˆä¸€ baobao lottery ğŸ§§</h1>

    <div id="countdown-section">
        <p class="subtitle" id="status-text">è·ç¦»æŠ½å¥–å¼€å§‹è¿˜æœ‰</p>
        <div class="timer-box">
            <div class="timer-display" id="timer">--:--:--</div>
            <div class="timer-label">å°æ—¶ : åˆ†é’Ÿ : ç§’</div>
        </div>
    </div>

    <div id="game-area">
        
        <div id="shop-panel">
            <div class="shop-info">
                å‰©ä½™æŠ½å¥–æ¬¡æ•°: <span id="chance-display" class="count-badge">0</span>
            </div>
            <button id="buy-btn" class="buy-btn" onclick="buyChance()">
                <span>ğŸ’‹ æ”¯ä»˜ 1 ä¸ªäº²äº²</span>
            </button>
            <p style="font-size: 0.8rem; color: #ccc; margin-top: 10px;">
                (æ¯äººé™è´­ 3 æ¬¡ï¼Œå½“å‰å·²è´­: <span id="bought-count">0</span>/3)
            </p>
        </div>

        <p class="subtitle">ç‚¹å‡»ä»»æ„çº¢åŒ…ï¼Œå¼€å¯æ‚¨çš„æ–°å¹´å¥½è¿ï¼</p>
        <div class="envelope-container" id="grid"></div>
        
        <div class="controls">
            <button class="reset-btn" onclick="resetGame()">ğŸ”„ ç®¡ç†å‘˜é‡ç½®</button>
        </div>
    </div>

    <div id="prizeModal">
        <div class="modal-content">
            <h2>ğŸ‰ æ­å–œä¸­å¥–ï¼ğŸ‰</h2>
            <p id="modalPrizeText">å¥–å“åç§°</p>
            <button class="modal-btn" onclick="closeModal()">å¼€å¿ƒæ”¶ä¸‹</button>
        </div>
    </div>

    <script>
        // ================= é…ç½®åŒºåŸŸ =================
        const targetDateString = "2026-02-17T22:00:00-05:00"; // ä»Šæ™š 10:00 PM ET
        const maxPurchases = 3; 

        // å¥–æ± é…ç½®ï¼šè¿™é‡Œå®šä¹‰äº† 12 ä¸ªçº¢åŒ…é‡Œå…·ä½“è—äº†ä»€ä¹ˆ
        // count çš„æ€»å’Œå¿…é¡»ç­‰äº 12
        const prizeConfig = [
            { name: "ç‰¹ç­‰å¥–ï¼š$100 å¤§çº¢åŒ…ï¼yayyyyyy!", count: 1 },
            { name: "ä¸€ç­‰å¥–ï¼š$20 å°çº¢åŒ…ï¼woohoooo!", count: 2 },
            { name: "äºŒç­‰å¥–ï¼šäº²äº²ï¼kissssyyyyy!", count: 4 },
            { name: "ä¸‰ç­‰å¥–ï¼šæŠ±æŠ±ï¼hugggyyyyyy!", count: 5 }
        ];
        // 1+2+4+5 = 12 ä¸ªå¥–å“

        // ================= çŠ¶æ€å˜é‡ =================
        let chancesLeft = 0;
        let boughtTotal = 0;
        let shuffledPrizePool = []; // å­˜å‚¨æ´—å¥½çš„ç‰Œ

        // ================= å€’è®¡æ—¶é€»è¾‘ =================
        const countDownDate = new Date(targetDateString).getTime();
        const countdownSection = document.getElementById("countdown-section");
        const gameArea = document.getElementById("game-area");
        const timerDisplay = document.getElementById("timer");

        const x = setInterval(function() {
            const now = new Date().getTime();
            const distance = countDownDate - now;

            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);

            const h = hours < 10 ? "0" + hours : hours;
            const m = minutes < 10 ? "0" + minutes : minutes;
            const s = seconds < 10 ? "0" + seconds : seconds;

            timerDisplay.innerHTML = h + " : " + m + " : " + s;

            if (distance < 0) {
                clearInterval(x);
                unlockGame();
            }
        }, 1000);

        function unlockGame() {
            countdownSection.style.display = "none";
            gameArea.style.display = "flex";
            initGame();
        }

        const nowInit = new Date().getTime();
        if (nowInit > countDownDate) {
            clearInterval(x);
            unlockGame();
        }

        // ================= è´­ä¹°é€»è¾‘ =================
        function buyChance() {
            if (boughtTotal >= maxPurchases) {
                alert("è´ªå¿ƒå°çŒªï¼ä»Šå¤©çš„é¢åº¦å·²ç»ç”¨å®Œå•¦ï¼ğŸ·");
                return;
            }

            if (confirm("æ”¯ä»˜è¯·æ±‚ï¼š\n\nè¯·ç«‹åˆ»ç»™å¯¹æ–¹ä¸€ä¸ªå“äº®çš„äº²äº²ï¼ğŸ’‹\n\n(äº²å®Œåç‚¹å‡»â€œç¡®å®šâ€é¢†å–æ¬¡æ•°)")) {
                chancesLeft++;
                boughtTotal++;
                updateUI();
                alert("ğŸ˜˜ æ”¯ä»˜æˆåŠŸï¼æŠ½å¥–æ¬¡æ•° +1");
            }
        }

        function updateUI() {
            document.getElementById("chance-display").innerText = chancesLeft;
            document.getElementById("bought-count").innerText = boughtTotal;

            const btn = document.getElementById("buy-btn");
            if (boughtTotal >= maxPurchases) {
                btn.disabled = true;
                btn.innerHTML = "<span>ğŸš« ä»Šæ—¥é¢åº¦å·²æ»¡</span>";
                btn.style.background = "#ccc";
                btn.style.color = "#666";
            }

            const envelopes = document.querySelectorAll('.envelope');
            envelopes.forEach(env => {
                if (!env.classList.contains('opened')) {
                    if (chancesLeft > 0) {
                        env.classList.add('active-state');
                        env.style.cursor = "pointer";
                    } else {
                        env.classList.remove('active-state');
                        env.style.cursor = "not-allowed";
                    }
                }
            });
        }

        // ================= å¥–æ± é€»è¾‘ (æ´—ç‰Œç®—æ³•) =================
        // ç”Ÿæˆå¹¶æ‰“ä¹±å¥–æ± 
        function generateAndShufflePool() {
            let pool = [];
            // æ ¹æ®é…ç½®ç”Ÿæˆæ‰€æœ‰å¥–å“
            prizeConfig.forEach(item => {
                for(let i=0; i<item.count; i++) {
                    pool.push(item.name);
                }
            });

            // Fisher-Yates æ´—ç‰Œç®—æ³•
            for (let i = pool.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [pool[i], pool[j]] = [pool[j], pool[i]];
            }
            return pool;
        }

        function initGame() {
            const grid = document.getElementById('grid');
            if (grid.children.length > 0) return;

            grid.innerHTML = ''; 
            
            // 1. ç”Ÿæˆæ´—å¥½çš„å¥–æ± 
            shuffledPrizePool = generateAndShufflePool();

            // 2. å°†å¥–å“ç»‘å®šåˆ°æ¯ä¸€ä¸ªçº¢åŒ…ä¸Š
            for (let i = 0; i < shuffledPrizePool.length; i++) {
                const env = document.createElement('div');
                env.className = 'envelope';
                const prizeText = document.createElement('div');
                prizeText.className = 'prize-text';
                env.appendChild(prizeText);

                // é‡ç‚¹ï¼šå¥–å“åœ¨åˆå§‹åŒ–æ—¶å°±å·²ç»ç¡®å®šäº†
                const thisEnvelopePrize = shuffledPrizePool[i];

                env.onclick = function() {
                    if (this.classList.contains('opened')) return;

                    if (chancesLeft <= 0) {
                        alert("æ²¡æœ‰æŠ½å¥–æ¬¡æ•°å•¦ï¼\nè¯·å…ˆç‚¹å‡»ä¸Šæ–¹çš„æŒ‰é’®è´­ä¹°ï¼ğŸ’‹");
                        return;
                    }

                    // å¼€å¥–
                    this.classList.add('opened');
                    this.classList.remove('active-state'); 
                    
                    prizeText.innerText = thisEnvelopePrize;
                    
                    chancesLeft--;
                    updateUI();

                    setTimeout(() => showModal(thisEnvelopePrize), 300);
                };
                grid.appendChild(env);
            }
            updateUI();
        }

        function showModal(prizeName) {
            document.getElementById('modalPrizeText').innerText = prizeName;
            document.getElementById('prizeModal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('prizeModal').style.display = 'none';
        }

        function resetGame() {
            if(confirm("ç®¡ç†å‘˜æ“ä½œï¼š\nç¡®å®šè¦é‡ç½®æ‰€æœ‰æ•°æ®å—ï¼Ÿ(æ‰€æœ‰çº¢åŒ…ä¼šé‡æ–°æ´—ç‰Œ)")) {
                const grid = document.getElementById('grid');
                grid.innerHTML = '';
                boughtTotal = 0;
                chancesLeft = 0;
                
                const btn = document.getElementById("buy-btn");
                btn.disabled = false;
                btn.innerHTML = "<span>ğŸ’‹ æ”¯ä»˜ 1 ä¸ªäº²äº²</span>";
                btn.style.background = ""; 
                btn.style.color = ""; 
                
                initGame();
            }
        }
    </script>
</body>
</html>
